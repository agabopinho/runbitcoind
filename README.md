# Bitcoin Core Node with Tor

This project sets up a Bitcoin Core full node that routes all traffic through the Tor network for enhanced privacy and anonymity.

## Overview

This project provides two distinct Docker Compose configurations:

**Sync Mode (`docker-compose-sync.yml`):**
- Bitcoin Core node optimized for fast initial blockchain download
- Direct clearnet connections for maximum speed
- 4GB cache and 200 connections for optimal performance

**Tor Mode (`docker-compose-tor.yml`):**
- Bitcoin Core node + Tor proxy for maximum privacy
- All traffic routed through Tor network
- Onion-only connections for enhanced anonymity

## Prerequisites

- Docker and Docker Compose installed on your system
- Sufficient disk space for the Bitcoin blockchain (>500GB recommended)
- Open ports on your firewall/router (if needed)

## Setup

This project includes two configurations:

### 1. Initial Blockchain Sync (Fast Download)
Use `docker-compose-sync.yml` for the initial blockchain download:

1. Clone this repository
2. Make sure you have the directory `D:/bitcoind` created (or modify the volume path)
3. Start the fast sync configuration:
   ```bash
   docker-compose -f docker-compose-sync.yml up -d
   ```
4. Monitor the sync progress:
   ```bash
   docker-compose -f docker-compose-sync.yml logs -f
   ```

### 2. Tor Configuration (After Sync)
Once the blockchain is fully synced, switch to the Tor configuration for privacy:

1. Stop the sync configuration:
   ```bash
   docker-compose -f docker-compose-sync.yml down
   ```
2. Start the Tor configuration:
   ```bash
   docker-compose -f docker-compose-tor.yml up -d
   ```
3. Check the logs:
   ```bash
   docker-compose -f docker-compose-tor.yml logs -f
   ```

## Configuration

### Fast Sync Configuration (`docker-compose-sync.yml`)
Optimized for initial blockchain download:
- **Cache**: 4GB database cache (`-dbcache=4096`) - 10x faster than default
- **Connections**: Up to 200 peer connections (`-maxconnections=200`)
- **Upload Limit**: 10GB bandwidth control (`-maxuploadtarget=10000`)
- **Network**: Direct clearnet connections (no Tor)
- **RPC**: Automatic secure credentials generation via `btc_oneshot`
- **Performance**: ~10x faster sync compared to default settings

### Tor Configuration (`docker-compose-tor.yml`)
Optimized for privacy after sync:
- **Privacy**: All traffic routed through Tor (`-proxy=tor:9050`)
- **Onion-Only**: Connects exclusively to .onion addresses (`-onlynet=onion`)
- **DNS Security**: DNS seeds disabled (`-dnsseed=0`)
- **Pre-configured Nodes**: Includes reliable .onion Bitcoin nodes
- **Cache**: 1GB cache (`-dbcache=1024`) - balanced for Tor usage
- **Services**: Includes Tor proxy container (`dperson/torproxy`)

## Accessing the Bitcoin node

### RPC Access
- **Port**: 8333 (P2P) and 8332 (RPC) mapped to host
- **Credentials**: Auto-generated by `btc_oneshot` script
  - Username: `bitcoinrpc` 
  - Password: Randomly generated on first start
- **Configuration**: Check `D:/bitcoind/bitcoin.conf` for current credentials

### Network Access
- **Sync Mode**: Direct internet connection for fast download
- **Tor Mode**: SOCKS5 proxy available on port 9050

### Checking Status
```bash
# Check sync progress
docker-compose -f docker-compose-sync.yml exec bitcoind bitcoin-cli getblockchaininfo

# Check network connections  
docker-compose -f docker-compose-sync.yml exec bitcoind bitcoin-cli getnetworkinfo

# View RPC credentials
docker-compose -f docker-compose-sync.yml exec bitcoind cat ~/.bitcoin/bitcoin.conf
```

## Data Storage

The Bitcoin blockchain data is stored in `D:/bitcoind` on your host system.

## Network

Both containers operate on an isolated Docker bridge network called `bitcoin-net`.

## Security Considerations

### Sync Mode Security
- **Performance vs Privacy**: Fast sync uses clearnet connections
- **Temporary**: Switch to Tor mode after initial blockchain download
- **Network Exposure**: Bitcoin node activity visible to ISP during sync

### Tor Mode Security  
- **Maximum Privacy**: All Bitcoin traffic routed through Tor
- **Onion-Only**: No clearnet connections (`-onlynet=onion`)
- **DNS Protection**: DNS seeds disabled to prevent leaks
- **Credential Security**: Auto-generated RPC passwords
- **Network Isolation**: Bitcoin and Tor on isolated Docker network

### Best Practices
- Use sync mode only for initial download
- Switch to Tor mode for regular operation
- Monitor disk space (blockchain >500GB)
- Keep Docker images updated
- Backup wallet files if using wallet features

## Maintenance

- Keep both Docker images updated regularly for security patches
- Monitor disk space usage as the blockchain grows over time